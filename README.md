PRM: codes in NANet project. 
TODO: re-orgnize the code.